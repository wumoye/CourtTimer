# CourtTimer 项目备忘

## 目标与确认需求
- Flutter 多平台计时器，提供预设 6 分钟、1 分钟、30 秒以及自定义时长。
- 服务篮球自训练或对抗赛使用，开局需有 3-2-1 语音预热，运行期间保持屏幕常亮。
- 运行时按启用的节点（120/60/30 秒）播报剩余时间，可选 10~0 逐秒倒计时。
- 支持开始 / 暂停 / 重置操作，按钮与长按手势两种入口。
- TTS 使用中文语音，语速适中，播报内容贴合篮球比赛节奏。

## 已实现功能
- `TimerController` 管理状态、语音播报、里程碑以及屏幕唤醒。
- UI 组件 `DurationSelector`、`AnnouncementPanel`、`TimerDisplay` 与自定义时长弹窗协同工作。
- `DurationFormatter` 提供 mm:ss 数字格式与中文标签，界面与语音共用。
- `SpeechService` 封装 `flutter_tts`，负责开始、时间到、剩余时长及逐秒倒计时播报。
- 基础 Widget 测试覆盖 `TimerPage` 主要组件渲染。
- 已完成 `flutter analyze` 与 `flutter test`。

## 待办与建议
- 增加不同语音风格或音色选择。
- 支持更多播报策略（震动、提示音等）。
- 持久化保存用户偏好设置。
- 扩展多语言 / 主题、自适应平板布局。
- 视需求补充更细粒度的单元或集成测试。

## 最新更新
- 修复时间格式化仅显示冒号与语音播报不完整的问题。
- 替换默认计数器测试为计时器页面渲染测试。
- 暂停后恢复计时将直接继续，不再触发 3-2-1 语音预热。
- 语音提示贴合篮球场景：开场“计时开始，准备进攻！”，时间到前播放系统提示音并播报“时间到！”，里程碑提醒“保持节奏！”。
- 2025-10-07：`flutter analyze` 与 `flutter test` 均通过。

## 协作规则
- 优先在原有 `memo.md` 基础上增量编辑，除非编码等问题无法修复再考虑重建。
- 关键文档建议及时提交到 Git，确保随时可回滚历史变更。
- 每次完成功能或调整配置后，及时更新备忘录，保持记录与实际实现一致。
